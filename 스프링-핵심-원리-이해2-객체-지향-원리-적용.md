## **스프링 핵심 원리 이해2 - 객체 지향 원리 적용**
  * 새로운 할인 정책 개발
    
    ![image](https://user-images.githubusercontent.com/79301439/159166842-390a2b00-03c0-4236-a2ed-f62c6d713a84.png)

    ![image](https://user-images.githubusercontent.com/79301439/159166851-9ee97eb6-0902-40e8-b160-7db339cab1ee.png)

    * RateDiscountPolicy 코드 추가
      ```java
      package hello.core.discount;

      import hello.core.member.Grade;
      import hello.core.member.Member;

      public class RateDiscountPolicy implements DiscountPolicy {

          private int discountPercent = 10; //10% 할인

          @Override
          public int discount(Member member, int price) {
              if (member.getGrade() == Grade.VIP) {
                  return price * discountPercent / 100;
              } else {
                  return 0;
              }
          }
      }
      ```
    * 테스트 작성
      ```java
      package hello.core.discount;

      import hello.core.member.Grade;
      import hello.core.member.Member;
      import org.junit.jupiter.api.DisplayName;
      import org.junit.jupiter.api.Test;

      import static org.assertj.core.api.Assertions.assertThat;

      class RateDiscountPolicyTest {

          RateDiscountPolicy rateDiscountPolicy = new RateDiscountPolicy();

          @Test
          @DisplayName("VIP는 10% 할인이 적용되어야 한다.")
          void vip_o() {
              //given
              Member member = new Member(1L, "memberVIP", Grade.VIP);

              //when
              int discount = rateDiscountPolicy.discount(member, 10000);

              //then
              assertThat(discount).isEqualTo(1000);
          }

          @Test
          @DisplayName("VPI가 아니면 할인이 적용되지 않아야 한다.")
          void vip_x() {
              //given
              Member member = new Member(2L, "memberBASIC", Grade.BASIC);

              //when
              int discount = rateDiscountPolicy.discount(member, 10000);

              //then
              assertThat(discount).isEqualTo(0);
          }

      }
      ```
      
      ![image](https://user-images.githubusercontent.com/79301439/159166945-a9e42a1d-e4cf-4b4a-9ec6-96a41e6996bb.png)
***
  * 새로운 할인 정책 적용과 문제점
    * 할인 정책을 변경하려면 `OrderServiceImpl` 코드를 고쳐야 한다.
      ```java
      public class OrderServiceImpl implements OrderService {

          //private final DiscountPolicy discountPolicy = new FixDiscountFolicy();
          private final DiscountPolicy discountPolicy = new RateDiscountPolicy();
      
      }
      ```
    * 문제점 발견
      
      ![image](https://user-images.githubusercontent.com/79301439/159167994-a16c6795-9a95-4b59-8e72-65d15af7c758.png)
      
    * 왜 클라이언트 코드를 변경해야 할까?
     
      ![image](https://user-images.githubusercontent.com/79301439/159168041-fd156212-d5ae-4b28-bfea-8c333631c557.png)

      ![image](https://user-images.githubusercontent.com/79301439/159168089-099f7e49-caa4-4913-9ea2-48336d9249c7.png)

      ![image](https://user-images.githubusercontent.com/79301439/159168119-d01f2825-7c40-47ee-9709-aed76184e3ac.png)

    * 어떻게 문제를 해결할 수 있을까?

      ![image](https://user-images.githubusercontent.com/79301439/159168145-f0ebb1af-3519-4d51-b6e5-5e9561264e35.png)

    * 인터페이스에만 의존하도록 설계를 변경
    
      ![image](https://user-images.githubusercontent.com/79301439/159168205-03af152e-d89f-45cc-be10-b7ece3ef007a.png)
      
    * 인터페이스에만 의존하도록 코드 변경
      ```java
      public class OrderServiceImpl implements OrderService {

          //private final DiscountPolicy discountPolicy = new RateDiscountPolicy();
          private DiscountPolicy discountPolicy;
          
      }
      ```
      
      ![image](https://user-images.githubusercontent.com/79301439/159168283-de295c86-f10d-4f6d-bef4-ebdb0438d969.png)
      
    * 해결 방안
      
      ![image](https://user-images.githubusercontent.com/79301439/159168292-f715ba6a-3826-4cb5-9592-ee6cd3f1ef70.png)
